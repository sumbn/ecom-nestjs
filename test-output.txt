
> ecomerce-vercel@0.0.1 test:e2e
> jest --config ./test/jest-e2e.json test/categories/categories.e2e-spec.ts --forceExit

node.exe : FAIL 
test/categories/categories.e2e-spec.ts 
(14.489 s)
At line:1 char:1
+ & "C:\nvm4w\nodejs/node.exe" "C:\nvm4w
\nodejs/node_modules/npm/bin/np ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecif 
   ied: (FAIL test/categ...c.ts (14.48  
  9 s):String) [], RemoteException
    + FullyQualifiedErrorId : NativeCom 
   mandError
 
  Categories (e2e)
    POST /categories
      ΓêÜ admin should create a root 
category (249 ms)
      ΓêÜ admin should create a child 
category (298 ms)
      ΓêÜ should fail with duplicate 
slug (101 ms)
      ΓêÜ should fail with invalid slug 
format (73 ms)
      ΓêÜ should fail with non-existent 
parent (286 ms)
      ΓêÜ regular user should not 
create category (256 ms)
      ΓêÜ should fail without 
authentication (10 ms)
    GET /categories
      ΓêÜ should return paginated 
categories (public) (301 ms)
      ΓêÜ should filter by active 
status (75 ms)
      ΓêÜ should search by keyword (264 
ms)
      ΓêÜ should be accessible without 
authentication (86 ms)
    GET /categories/tree
      ΓêÜ should return category tree 
structure (public) (909 ms)
      ΓêÜ should filter tree by active 
status (116 ms)
    GET /categories/roots
      ΓêÜ should return root categories 
only (public) (52 ms)
    GET /categories/:id
      ΓêÜ should return category by id 
(public) (120 ms)
      ΓêÜ should return 404 for 
non-existent category (2 ms)
    GET /categories/slug/:slug
      ΓêÜ should return category by 
slug (public) (105 ms)
      ΓêÜ should return 404 for 
non-existent slug (54 ms)
    GET /categories/:id/children
      ΓêÜ should return direct children 
(public) (54 ms)
    GET /categories/:id/ancestors
      ΓêÜ should return ancestors 
(breadcrumb) (public) (149 ms)
    GET /categories/:id/descendants
      ΓêÜ should return descendants 
tree (public) (152 ms)
    PATCH /categories/:id
      ΓêÜ admin should update category 
(462 ms)
      ΓêÜ should fail with duplicate 
slug on update (435 ms)
      ΓêÜ regular user should not 
update category (105 ms)
      ΓêÜ should return 404 for 
non-existent category (151 ms)
    PATCH /categories/:id/move
      ΓêÜ admin should move category to 
different parent (1033 ms)
      ├ù should fail to create circular 
reference (1194 ms)
      ΓêÜ regular user should not move 
category (106 ms)
    PATCH /categories/bulk/display-order
      ΓêÜ admin should bulk update 
display order (298 ms)
      ΓêÜ regular user should not bulk 
update (103 ms)
    DELETE /categories/:id
      ΓêÜ should fail to delete 
category with children (257 ms)
      ΓêÜ admin should delete leaf 
category (454 ms)
      ΓêÜ regular user should not 
delete category (102 ms)
      ΓêÜ should return 404 for 
non-existent category (149 ms)
    Response format validation
      ΓêÜ all category endpoints should 
follow standard response format (111 ms)

  ΓùÅ Categories (e2e) ΓÇ║ PATCH 
/categories/:id/move ΓÇ║ should fail to 
create circular reference

    
expect(received).toContain(expected) // 
indexOf

    Expected value: "circular reference"
    Received array: ["Cannot move 
category: would create circular 
reference"]

    [0m [90m 519 |[39m         
[33m.[39mexpect([35m400[39m)
     [90m 520 |[39m         
[33m.[39mthen((response) [33m=>[39m 
{
    [31m[1m>[22m[39m[90m 521 
|[39m           expect(response[33m.[
39mbody[33m.[39mmessage)[33m.[39mtoC
ontain([32m'circular 
reference'[39m)[33m;[39m
     [90m     |[39m                   
                      
[31m[1m^[22m[39m
     [90m 522 |[39m         
})[33m;[39m
     [90m 523 |[39m     })[33m;[39m
     [90m 524 |[39m[0m

      at 
categories/categories.e2e-spec.ts:521:41

Test Suites: 1 failed, 1 total
Tests:       1 failed, 34 passed, 35 
total
Snapshots:   0 total
Time:        14.766 s, estimated 15 s
Ran all test suites matching 
test/categories/categories.e2e-spec.ts.
Force exiting Jest: Have you considered 
using `--detectOpenHandles` to detect 
async operations that kept running 
after all tests finished?
